# MMA Platform

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ –æ –±–æ–π—Ü–∞—Ö, —Å–æ–±—ã—Ç–∏—è—Ö, –±–æ—è—Ö –∏ —Ä–µ–π—Ç–∏–Ω–≥–∞—Ö –≤ —Å–º–µ—à–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–æ–±–æ—Ä—Å—Ç–≤–∞—Ö (MMA). –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **NestJS**, **TypeORM**, **PostgreSQL** –∏ **GraphQL**.

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏ MMA, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –≤–µ—Å–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –±–æ–π—Ü—ã, —Å–æ–±—ã—Ç–∏—è, –±–æ–∏ –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏. –û–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π CRUD (Create, Read, Update, Delete) –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ –≤–∫–ª—é—á–∞–µ—Ç –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–æ–µ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

1. **WeightClass** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
2. **Fighter** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–π—Ü–∞–º–∏ –∏ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
3. **Event** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏ (—Ç—É—Ä–Ω–∏—Ä–∞–º–∏)
4. **Fight** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—è–º–∏ –º–µ–∂–¥—É –±–æ–π—Ü–∞–º–∏
5. **Ranking** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ –±–æ–π—Ü–æ–≤ –≤ –≤–µ—Å–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Node.js**: v18.x –∏–ª–∏ –≤—ã—à–µ
- **PostgreSQL**: v13.x –∏–ª–∏ –≤—ã—à–µ
- **npm**: v8.x –∏–ª–∏ –≤—ã—à–µ

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
   ```bash
   git clone <repository-url>
   cd mma-platform
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   npm install
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**:
   - –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL:
     ```sql
     CREATE DATABASE mma;
     ```
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ `src/app.module.ts`:
     ```typescript
     TypeOrmModule.forRoot({
       type: 'postgres',
       host: 'localhost',
       port: 5432,
       username: 'postgres',
       password: 'your_password',
       database: 'mma',
       entities: [Event, Fight, Fighter, WeightClass, Ranking],
       synchronize: true, // –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–∫–ª—é—á–∏—Ç—å
       logging: true,
     }),
     ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**:
   ```bash
   npm run start:dev
   ```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000/graphql`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mma-platform/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ dto/                # DTO –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ entities/           # –°—É—â–Ω–æ—Å—Ç–∏ TypeORM
‚îÇ   ‚îú‚îÄ‚îÄ event/             # –ú–æ–¥—É–ª—å —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ fight/             # –ú–æ–¥—É–ª—å –±–æ–µ–≤
‚îÇ   ‚îú‚îÄ‚îÄ fighter/           # –ú–æ–¥—É–ª—å –±–æ–π—Ü–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ranking/           # –ú–æ–¥—É–ª—å —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ weight-class/      # –ú–æ–¥—É–ª—å –≤–µ—Å–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts      # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ main.ts            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ schema.gql         # –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–∞—è GraphQL-—Å—Ö–µ–º–∞
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

## üìä GraphQL API

### WeightClass (–í–µ—Å–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)

#### –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Å–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```graphql
mutation {
  createWeightClass(data: { 
    name: "Lightweight", 
    minWeight: 70.3, 
    maxWeight: 77.1 
  }) {
    id
    name
    minWeight
    maxWeight
  }
}
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–µ—Å–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```graphql
query {
  weightClasses {
    id
    name
    minWeight
    maxWeight
  }
}
```

### Fighter (–ë–æ–π—Ü—ã)

#### –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–π—Ü–∞
```graphql
mutation {
  createFighter(data: { 
    firstName: "Conor", 
    lastName: "McGregor", 
    weightClassId: 1, 
    nickname: "The Notorious" 
  }) {
    id
    firstName
    lastName
    nickname
  }
}
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–æ–π—Ü–∞
```graphql
query {
  fighterStats(id: 1) {
    wins
    losses
    draws
    knockouts
    submissions
  }
}
```

### Event (–°–æ–±—ã—Ç–∏—è)

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
```graphql
mutation {
  createEvent(data: { 
    name: "UFC 300", 
    date: "2025-04-15", 
    location: "Las Vegas" 
  }) {
    id
    name
    date
    location
  }
}
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
```graphql
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —Å –¥–∞—Ç–æ–π –ø–æ–∑–∂–µ —Ç–µ–∫—É—â–µ–π
query {
  upcomingEvents {
    id
    name
    date
    location
    fights {
      fighter1 {
        firstName
        lastName
      }
      fighter2 {
        firstName
        lastName
      }
    }
  }
}
```

### Fight (–ë–æ–∏)

#### –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—è
```graphql
mutation {
  createFight(data: {
    eventId: 1
    fighter1Id: 1
    fighter2Id: 2
    winnerId: 1
    method: "KO"
    round: 2
    time: "01:23"
    fightDate: "2025-04-15"
  }) {
    id
    eventId
    fighter1Id
    fighter2Id
    method
  }
}
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –±–æ—è
```graphql
mutation {
  updateFight(id: 1, data: { 
    winnerId: 2,
    method: "Submission",
    round: 3
  }) {
    id
    winner {
      firstName
      lastName
    }
    method
    round
  }
}
```

### Ranking (–†–µ–π—Ç–∏–Ω–≥–∏)

#### –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞
```graphql
mutation {
  createRanking(data: { 
    fighterId: 1, 
    weightClassId: 1, 
    rank: 5 
  }) {
    id
    rank
    fighter {
      firstName
      lastName
    }
  }
}
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ –≤–µ—Å–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```graphql
query {
  rankingsByWeightClass(weightClassId: 1) {
    rank
    fighter {
      firstName
      lastName
    }
  }
}
```

#### –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
```graphql
mutation {
  updateRankingsAfterFight(fightId: 1)
}
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤**: 
   - –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏:
     - –°–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –±–æ—è (`createFight`)
     - –û–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—è (`updateFight`)
   - –£—Å–ª–æ–≤–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
     - –£–∫–∞–∑–∞–Ω –ø–æ–±–µ–¥–∏—Ç–µ–ª—å –±–æ—è (`winnerId`)
     - –ë–æ–π—Ü—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫ –æ–¥–Ω–æ–π –≤–µ—Å–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ `updateRankingsAfterFight(fightId)`

2. **–†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏**:
   - –î–ª—è `upcomingEvents` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –¥–∞—Ç–∞
   - –§–æ—Ä–º–∞—Ç –¥–∞—Ç: `YYYY-MM-DD` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "2025-04-15")
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è –±–æ–ª—å—à–µ —Ç–µ–∫—É—â–µ–π

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
   - –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `NOT_FOUND`
   - –í—Å–µ –º—É—Ç–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞—é—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**:
   - ERD –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ `docs/erd.png`
   - SQL-—Å–∫—Ä–∏–ø—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `docs/database.sql`

## üîç –û—Ç–ª–∞–¥–∫–∞

### –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
TRUNCATE TABLE rankings, fights, events, fighters, weight_classes 
RESTART IDENTITY CASCADE;
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä GraphQL —Å—Ö–µ–º—ã
```graphql
query {
  __schema {
    queryType {
      fields {
        name
      }
    }
  }
}
```